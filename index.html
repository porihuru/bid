<!--
[JST 2026-01-24 21:00]  index.html v20260124-01
入札者フォーム（個別JS読込運用）
  - Firebase Auth: 入札者ID + パスワード（匿名ログインなし）
  - 入札認証（コード）は従来どおり（authCode）
  - 00_bidder_build.js を復活（ビルドではなく起動前共通初期化用途）
  - 各JS冒頭で [ver] をログ出力
  - Edge95/IEモード想定: ES5記法
-->
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>入札者フォーム</title>
  <style>
    body{font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP",sans-serif;margin:0;background:#f6f7fb;color:#111;}
    header{padding:10px 12px;background:#111;color:#fff;}
    header .row{display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:wrap;}
    header .meta{font-size:12px;opacity:.9}
    main{padding:12px;max-width:980px;margin:0 auto;}
    .card{background:#fff;border:1px solid #e5e7ee;border-radius:10px;padding:12px;margin:10px 0;}
    .grid{display:grid;grid-template-columns:1fr;gap:10px;}
    @media(min-width:720px){ .grid2{grid-template-columns:1fr 1fr;} }
    label{display:block;font-size:12px;color:#333;margin:0 0 4px;}
    input,select,button,textarea{font:inherit;}
    input,select{width:100%;padding:10px;border:1px solid #cfd3df;border-radius:8px;}
    button{padding:10px 12px;border:1px solid #cfd3df;border-radius:8px;background:#fff;cursor:pointer;}
    button.primary{background:#111;color:#fff;border-color:#111;}
    button.danger{background:#fff;color:#b00020;border-color:#b00020;}
    button:disabled{opacity:.5;cursor:not-allowed;}
    .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap;}
    .hint{font-size:12px;color:#666}
    .status{font-size:12px;padding:6px 8px;border-radius:999px;background:#eef0f7;color:#333;display:inline-block;}
    table{width:100%;border-collapse:collapse;}
    th,td{border-bottom:1px solid #e8eaf2;padding:8px;font-size:14px;vertical-align:top;}
    th{background:#fafbff;text-align:left;}
    td.num{white-space:nowrap;text-align:right;}
    .logbox{width:100%;height:260px;padding:10px;border:1px solid #cfd3df;border-radius:8px;background:#0b0f1a;color:#e7e9f3;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;font-size:12px;}
    .muted{color:#777;}
    .sep{height:1px;background:#e5e7ee;margin:10px 0;}
    .small{font-size:12px;}
    .warn{color:#b00020;}
    /* 印刷 */
    @media print{
      header, .no-print { display:none !important; }
      body{background:#fff;}
      .card{border:0;}
      .logbox{display:none;}
    }
  </style>

  <!-- Firebase (compat) ※必要に応じてローカル配置へ置換してください -->
  <!--
    [CFG] ここは環境に合わせて差し替え
    - compat版（firebase-app-compat / firebase-auth-compat / firebase-firestore-compat）
  -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <!-- 個別JS（ビルド不要運用） -->
  <script src="./js/00_bidder_build.js"></script>
  <script src="./js/01_bidder_config.js"></script>
  <script src="./js/02_bidder_state.js"></script>
  <script src="./js/03_bidder_log.js"></script>
  <script src="./js/04_bidder_db.js"></script>
  <script src="./js/05_bidder_auth.js"></script>
  <script src="./js/06_bidder_profile.js"></script>
  <script src="./js/07_bidder_offer.js"></script>
  <script src="./js/08_bidder_render.js"></script>
  <script src="./js/09_bidder_print.js"></script>
  <script src="./js/10_bidder_app.js"></script>
</head>

<body>
<header>
  <div class="row">
    <div>
      <div><strong>入札者フォーム</strong></div>
      <div class="meta" id="hdrMeta">BID_NO=(none)</div>
    </div>
    <div class="row">
      <span class="status" id="hdrMode">mode: -</span>
      <button class="no-print" id="btnReload">再読込</button>
      <button class="no-print" id="btnPrint">印刷</button>
    </div>
  </div>
</header>

<main>

  <div class="card">
    <div class="row" style="justify-content:space-between;">
      <div>
        <div class="small muted">入札番号</div>
        <div id="bidNoView" style="font-weight:700;">(none)</div>
      </div>
      <div class="row no-print">
        <button id="btnLogClear">ログクリア</button>
      </div>
    </div>
    <div class="sep"></div>
    <div class="hint">
      進行: 「ログイン（入札者ID/パスワード）」→「入札認証（コード）」→「入札者情報入力」→「保存」
    </div>
  </div>

  <!-- ログイン -->
  <div class="card no-print">
    <div style="font-weight:700;margin-bottom:6px;">1) ログイン（Firebase認証）</div>
    <div class="grid grid2">
      <div>
        <label>入札者ID（例: 332b001）</label>
        <input id="inpBidderId" placeholder="332b001" autocomplete="username" />
      </div>
      <div>
        <label>パスワード（例: 123456）</label>
        <input id="inpPassword" placeholder="******" type="password" autocomplete="current-password" />
      </div>
    </div>
    <div class="row" style="margin-top:10px;">
      <button class="primary" id="btnLogin">ログイン</button>
      <button id="btnLogout">ログアウト</button>
      <span class="hint" id="loginHint"></span>
    </div>
  </div>

  <!-- 入札認証 -->
  <div class="card no-print">
    <div style="font-weight:700;margin-bottom:6px;">2) 入札認証（従来どおり）</div>
    <div class="grid grid2">
      <div>
        <label>認証コード（備考5）</label>
        <input id="inpAuthCode" placeholder="認証コードを入力してください。" />
        <div class="hint">認証成功後に入力が可能になります。</div>
      </div>
      <div>
        <label>&nbsp;</label>
        <button class="primary" id="btnAuth">認証</button>
      </div>
    </div>
  </div>

  <!-- 入札者情報 -->
  <div class="card">
    <div style="font-weight:700;margin-bottom:6px;">3) 入札者情報（必須）</div>

    <div class="grid grid2">
      <div>
        <label>メールアドレス</label>
        <input id="pEmail" placeholder="example@example.com" />
      </div>
      <div>
        <label>住所</label>
        <input id="pAddress" placeholder="札幌市..." />
      </div>
      <div>
        <label>会社名</label>
        <input id="pCompany" placeholder="〇〇株式会社" />
      </div>
      <div>
        <label>代表者名</label>
        <input id="pRep" placeholder="代表者名" />
      </div>
      <div>
        <label>担当者名</label>
        <input id="pPerson" placeholder="担当者名" />
      </div>
      <div>
        <label>担当者連絡先</label>
        <input id="pTel" placeholder="090-..." />
      </div>
    </div>

    <div class="row no-print" style="margin-top:10px;">
      <button id="btnLoadCookie">入力済データの読み込み</button>
      <button id="btnSaveCookie">入力済データを保存</button>
      <button class="danger" id="btnDelCookie">クッキー削除</button>
      <span class="hint" id="cookieHint"></span>
    </div>
  </div>

  <!-- 品目 -->
  <div class="card">
    <div style="font-weight:700;margin-bottom:6px;">4) 品目（単価入力）</div>
    <div class="hint">「品名＋規格」は1セル2段表示。合計金額は表示しません。</div>
    <div class="sep"></div>
    <div style="overflow:auto;">
      <table>
        <thead>
          <tr>
            <th style="width:70px;">番号</th>
            <th>品名 / 規格</th>
            <th style="width:120px;">予定数量</th>
            <th style="width:140px;">入札単価</th>
            <th style="width:140px;">備考</th>
          </tr>
        </thead>
        <tbody id="tbodyItems">
          <tr><td colspan="5" class="muted">読み込み中...</td></tr>
        </tbody>
      </table>
    </div>

    <div class="row no-print" style="margin-top:10px;">
      <button class="primary" id="btnSaveOffer">入札を保存</button>
      <span class="hint" id="saveHint"></span>
    </div>
    <div class="hint warn" id="saveWarn" style="margin-top:6px;"></div>
  </div>

  <!-- ログ -->
  <div class="card no-print">
    <div class="row" style="justify-content:space-between;">
      <div style="font-weight:700;">ログ</div>
      <div class="hint">各ボタン押下後に成功/失敗/理由を必ず表示します。</div>
    </div>
    <div class="sep"></div>
    <textarea id="txtLog" class="logbox" readonly></textarea>
  </div>

</main>
</body>
</html>
